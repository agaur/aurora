<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>iGraph</title>
<!--[if IE]>
<script type="text/javascript" src="https://getfirebug.com/firebug-lite.js"></script>
    <script type="text/javascript" src="lib/svg/svg.js" data-path="lib/svg/"></script>
<![endif]-->
<meta name="svg.render.forceflash" content="true">
<script type="text/javascript" src="lib/protovis-r3.3.js"></script>
<script type="text/javascript" src="lib/protovis-d3.3.js"></script>
<!--  custom js -->

</head>
<body>
	<div id="graph">
		<script type="text/javascript+protovis">
		setBarStyles = function (bar, graphDef, panel) {
			bar.data(function () {
				var arr = []
				for (i = 0; i < graphDef.data.length; i++) {
					arr.push(graphDef.data[i].value)
				}
				return arr;
			});
			bar.fillStyle("red");
			bar.width(20);
			bar.bottom(0);
			bar.height(function (d) {
				return d * 80;
			});
			bar.left(function () {
				return this.index * 40 + 20;
			});
		};
		function setLabelStyles(label, data) {
			label.text(function () {
				return data[this.index].label;
			});
			label.textAngle(-Math.PI/2);
			label.left(function () {
				return this.index * 40 + 20;
			});
			label.textAlign("left");
			label.bottom(20);
			
			return label;
		}
		function setRuleStyles(rule,config){
			rule.data(pv.range(0, 5, .5)).bottom(function(d){ return(d * 70)});
			rule.strokeStyle(config.color || "black");
			
		}
		function makeGraph(graphDef, renderDiv) {
			var styles = graphDef.styles;
			var panel = new pv.Panel();
			panel.add(pv.Label).text(graphDef.chart.caption).left(styles.width/2).top(20).textAlign("center");
			if(graphDef.rule){
				var rule = panel.add(pv.Rule);
				setRuleStyles(rule,graphDef.rule);
			}
			var bar = panel.add(pv.Bar);
			setBarStyles(bar, graphDef, panel);
			var label = bar.add(pv.Label);
			setLabelStyles(label, graphDef.data,bar);
			return panel;
		}

	var graphDef = {
		    "chart": {
		        "yaxisname": "Sales Figure",
		        "caption": "Top 5 Sales Person",
		        "numberprefix": "$",
		        "useroundedges": "1",
		        "bgcolor": "FFFFFF,FFFFFF",
		        "showborder": "0"
		    },
		    "data": [
		        {
		            "label": "Alex",
		            "value": "2.5"
		        },
		        {
		            "label": "Mark",
		            "value": "3.5"
		        },
		        {
		            "label": "David",
		            "value": "4.2"
		        },
		        {
		            "label": "Graham",
		            "value": "3.5"
		        },
		        {
		            "label": "John",
		            "value": "3.1"
		        }
		    ],
		    "styles": {
		    	"width":"400",
		    	"height":"400"
		    },
		    "rule":{
		    	//"color":"yellow"
		    }
		};
	var graph= makeGraph(graphDef,"graph");
	graph.render();
</script>
	</div>
</body>
</html>